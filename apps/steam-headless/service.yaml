---
# Service for Steam-Headless
# Exposes noVNC web UI and Sunshine streaming ports
apiVersion: v1
kind: Service
metadata:
  name: steam-headless
  namespace: steam-headless
spec:
  type: LoadBalancer  # Get an external IP from MetalLB
  selector:
    app: steam-headless
  ports:
    # noVNC web interface (for initial Steam login)
    - name: novnc-web
      port: 8083
      targetPort: 8083
      protocol: TCP

    # Sunshine web UI (for streaming configuration)
    - name: sunshine-web
      port: 47990
      targetPort: 47990
      protocol: TCP

    # Sunshine streaming - HTTPS
    - name: sunshine-https
      port: 47984
      targetPort: 47984
      protocol: TCP

    # Sunshine streaming - HTTP
    - name: sunshine-http
      port: 47989
      targetPort: 47989
      protocol: TCP

    # Sunshine streaming - RTSP (TCP)
    - name: sunshine-rtsp
      port: 48010
      targetPort: 48010
      protocol: TCP

    # Sunshine video streaming (UDP)
    - name: sun-video
      port: 47998
      targetPort: 47998
      protocol: UDP

    # Sunshine audio streaming (UDP)
    - name: sun-audio
      port: 47999
      targetPort: 47999
      protocol: UDP

    # Sunshine control (UDP)
    - name: sun-ctrl
      port: 48000
      targetPort: 48000
      protocol: UDP

    # Sunshine control 2 (UDP)
    - name: sun-ctrl2
      port: 48002
      targetPort: 48002
      protocol: UDP

    # Sunshine RTSP (UDP)
    - name: sun-rtsp-udp
      port: 48010
      targetPort: 48010
      protocol: UDP

    # mDNS for Moonlight discovery (UDP)
    - name: mdns
      port: 5353
      targetPort: 5353
      protocol: UDP
